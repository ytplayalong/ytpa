(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[300],{7734:function(e,t,r){Promise.resolve().then(r.bind(r,5060)),Promise.resolve().then(r.bind(r,4267))},5060:function(e,t,r){"use strict";r.d(t,{default:function(){return H}});var n=r(7437),a=r(9376),i=r(2641),s=r(2265),l=r(2828);class o{interpolate(e){var t,r,n,a,i,s,l,o,c,d;for(s=d=this.x.length-2;(d<=0?s<=0:s>=0)&&!(this.x[s]<=e);d<=0?s+=1:s-=1);return t=this.x[s+1]-this.x[s],o=Math.pow(l=(e-this.x[s])/t,2),r=2*(c=Math.pow(l,3))-3*o+1,a=c-2*o+l,n=-2*c+3*o,i=c-o,r*this.y[s]+a*t*this.m[s]+n*this.y[s+1]+i*t*this.m[s+1]}constructor(e,t){var r,n,a,i,s,l,o,c,d,h,u,m,g,x,p,f,v;for(s=0,o=e.length,a=[],l=[],r=[],n=[],i=[],c=[],x=o-1;0<=x?s<x:s>x;0<=x?s+=1:s-=1)a[s]=(t[s+1]-t[s])/(e[s+1]-e[s]),s>0&&(l[s]=(a[s-1]+a[s])/2);for(s=0,l[0]=a[0],l[o-1]=a[o-2],d=[],p=o-1;0<=p?s<p:s>p;0<=p?s+=1:s-=1)0===a[s]&&d.push(s);for(h=0,m=d.length;h<m;h++)l[s=d[h]]=l[s+1]=0;for(s=0,f=o-1;0<=f?s<f:s>f;0<=f?s+=1:s-=1)r[s]=l[s]/a[s],n[s]=l[s+1]/a[s],i[s]=Math.pow(r[s],2)+Math.pow(n[s],2),c[s]=3/Math.sqrt(i[s]);for(s=0,d=[],v=o-1;0<=v?s<v:s>v;0<=v?s+=1:s-=1)i[s]>9&&d.push(s);for(u=0,g=d.length;u<g;u++)l[s=d[u]]=c[s]*r[s]*a[s],l[s+1]=c[s]*n[s]*a[s];this.x=e.slice(0,o),this.y=t.slice(0,o),this.m=l}}function c(){let{innerWidth:e,innerHeight:t}=window;return{width:e,height:t}}var d=r(4267);let h="osmd";class u extends l.OpenSheetMusicDisplay{setup(){this.rules.FingeringPosition=1,this.rules.FingeringOffsetY=1,this.rules.FingeringPositionFromXML=!1}}let m=async(e,t,r,n)=>{let a=new u(h,{drawCredits:!1,drawPartNames:!1,measureNumberInterval:4});return a.setup(),await a.load(e),a.setCustomPageFormat(t,r),a.Zoom=n,a.render(),a},g=(e,t)=>{let r=e.GraphicSheet.MeasureList,n=r.map(e=>{var t;return null===(t=e[0])||void 0===t?void 0:t.stave.x});if(!d.settingsManager.isHorizontalMode()){let e=r.map(e=>{var t;return null===(t=e[0])||void 0===t?void 0:t.stave.y}),t=e[0];e=e.map(e=>e-t);let a={},i=0,s=e[0];e.forEach(e=>{e===s?i+=1:(a[s]=i,s=e,i=1)});let l=a[s=e[0]],o=0,c=0;e.forEach((t,r)=>{t!==s&&(c=r-1,o=t-s,s=t),e[r]-=(l-r+c+1)*o/(l+1)}),n=e}let a=Object.entries(t).map(e=>[parseFloat(e[0]),e[1]]);a.sort((e,t)=>e[0]-t[0]);let i=a[a.length-1],s=[1,2].map(e=>[i[0]+5*e,i[1]]),l=(a=[[0,0]].concat(a).concat(s)).length,[c,h]=a[0],u=[],m=[];for(let e=0;e<l-1;++e){let[t,r]=a[e+1];if(void 0!==n[r-1]){for(let e=h;e<r;++e){let a=n[e-1];if(void 0!==a){let n=c+(t-c)*(e-h)/(r-h);u.push(n),m.push(a)}}c=t,h=r}}u.push(c),m.push(n[h-1]),console.log(u,m);let g=d.settingsManager.isHorizontalMode()?.3:0,x=new o(u,m);return(e,t)=>{let r=g*window.innerWidth;return Math.max(0,x.interpolate(e)*t-r)}},x=e=>{let[t,r]=(0,s.useState)({x:0,y:0}),[a,i]=(0,s.useState)(null),{height:l}=function(){let[e,t]=(0,s.useState)(c());return(0,s.useEffect)(()=>{function e(){t(c())}return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}(),o=d.settingsManager.getZoom(),u=Math.max(150,.2*l),x=Math.max(Math.min(1,u/260),.5)*o,p=u*x,f=d.settingsManager.isHorizontalMode()?4e4*p:window.innerWidth,{getTime:v,measureMap:y,xml:w}=e;(0,s.useEffect)(()=>((async()=>{let e=d.settingsManager.isHorizontalMode()?u*o:1e5;i({ip:g(await m(w,f,e,x),y)})})(),()=>{i(null)}),[w,y,u,o,f]),(0,s.useEffect)(()=>{if(null!==a){let e=a.ip,t=setInterval(async()=>{let t=e(await v(),x);r(d.settingsManager.isHorizontalMode()?{x:t,y:0}:{x:0,y:t})},20);return()=>{clearInterval(t)}}},[v,a,x]);let M=d.settingsManager.isHorizontalMode()?u*o:800;return(0,n.jsx)("div",{style:{overflow:"hidden"},children:(0,n.jsx)("div",{id:h,style:{height:"".concat(M+t.y,"px"),width:"".concat(f,"px"),marginLeft:"-".concat(t.x,"px"),marginTop:"-".concat(t.y,"px")}})})};var p=r(5259),f=r(5061),v=r(8138);let y=[1,0,-1],w=async e=>(await fetch(e)).text(),M=(e,t,r,n)=>{let a=(0,i.s1)(e,t);a.childNodes.forEach(e=>{e.nodeName===r&&e.id!==n&&a.removeChild(e)})},j=e=>{let t=e.cloneNode(!0);return t.xmlStandalone=e.xmlStandalone,t},I=e=>{let t=e.parts[e.currPartIdx].id,r=j(e.origXml);M(r,"part-list","score-part",t),M(r,"score-partwise","part",t);let n=d.settingsManager.getFingering();return(0,i.p4)(r,e.pitch,e.octave,n),r},E=e=>{let t=(0,i.s1)(e,"score-partwise"),r=[],n=t.getElementsByTagName("score-part");for(let e=0;e<n.length;++e)r.push({id:n[e].id,name:n[e].getElementsByTagName("part-name")[0].textContent});return r},P=()=>d.settingsManager.getInstrumentKey(),N=e=>{let{scoreInfo:t,player:r}=e,a="/mxl/".concat(t.fileName,".musicxml"),l="https://musescore.com/user/83726533/scores/".concat(t.source),{t:o}=(0,v.Z)(),[c,d]=(0,s.useState)(null);if((0,s.useEffect)(()=>{(async()=>{let e=await w(a),t=(0,i.ON)(e),r={xml:t,parts:E(t),currPartIdx:0,origXml:t,pitch:P(),octave:0};d({...r,xml:I(r)})})()},[a]),null!==c){let e=c.pitch,s=c.currPartIdx,h=c.octave,u=(t,r,n)=>{if(t===s&&r===e&&n===h)return;let a={...c,currPartIdx:t,pitch:r,octave:n},i=I(a);d({...a,xml:i,currPartIdx:t})},m=e=>e>0?"+".concat(e):"".concat(e),g=o("octave"),v=0===h?g:"".concat(g,": ").concat(m(h)),w=y.map(t=>({name:m(t),onClick:()=>u(s,e,t),key:m(t)})),M=(0,n.jsx)(p.H,{options:w,children:v}),j=e=>u(s,e,h),E=i.xj.map((e,t)=>({name:e,onClick:()=>j(e),key:e})),P=o("instrumentKeyShort"),N=(0,n.jsx)(p.H,{options:E,children:"".concat(P,": ").concat(e)}),b=(0,n.jsxs)("div",{style:f.Pp,children:[N,M]}),S=(0,n.jsx)(x,{xml:c.xml,measureMap:t.measureMap,getTime:r.getTime},a),k=(0,n.jsx)("div",{style:{width:i.g1.width,maxWidth:i.g1.maxWidth,margin:"auto"},children:(0,n.jsxs)("div",{style:{...f.yR,...f.W9},children:[(0,n.jsxs)("h4",{children:[o("viewSheetsOn"),(0,n.jsx)("br",{}),(0,n.jsx)("a",{href:l,target:"_blank",children:"MuseScore.com"})]}),b]})}),C=(0,n.jsx)("div",{style:{width:i.g1.width,maxWidth:i.g1.maxWidth,margin:"auto"},children:(0,n.jsxs)("div",{style:{...f.yR,...f.W9},children:[(0,n.jsx)("h3",{children:t.name}),(0,n.jsx)("h3",{children:"-"}),(0,n.jsx)("h3",{children:t.artist})]})});return(0,n.jsxs)(n.Fragment,{children:[C,r.comp,k,S]})}return(0,n.jsx)("div",{className:"container",children:(0,n.jsx)("div",{style:f.yR,children:"Loading..."})})};var b=r(5107);let S=e=>{let t=(0,s.useRef)(),r=(0,s.useCallback)(async()=>await t.current.getInternalPlayer().getCurrentTime(),[t]);return{comp:(0,n.jsx)(k,{playerRef:t,videoId:e}),getTime:r}},k=e=>{let{videoId:t,playerRef:r}=e,a={...i.g1,playerVars:{autoplay:1}},l=s.createElement(b.Z,{videoId:t,opts:a,ref:r,onReady:()=>console.log("I'm ready, loaded ".concat(t,"!"))});return(0,n.jsx)("div",{style:{...i.g1,margin:"auto"},children:(0,n.jsx)("div",{style:f.yR,children:l})})},C=e=>{let{scoreInfo:t}=e,r=S(t.videoId);return(0,n.jsx)(N,{scoreInfo:t,player:r})};var H=()=>{let e=(0,a.usePathname)().split("/")[3],t=i.f$.filter(t=>t.videoId===e);if(0===t.length)return(0,n.jsxs)("h3",{children:["YouTube score with ID ",(0,n.jsx)("b",{children:e})," not found :("]});let r=t[0];return(0,n.jsx)(C,{scoreInfo:r})}}},function(e){e.O(0,[170,822,648,739,209,971,117,744],function(){return e(e.s=7734)}),_N_E=e.O()}]);