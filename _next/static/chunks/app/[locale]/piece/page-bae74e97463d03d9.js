(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[308],{1203:(e,t,r)=>{"use strict";r.d(t,{QueryScore:()=>U});var n=r(5155),i=r(63),s=r(2115),a=r(2271),l=r(8242),o=r(883);let c=e=>{let{videoId:t,playerRef:r}=e,i={...o.$n,playerVars:{autoplay:1}},c=s.createElement(a.A,{videoId:t,opts:i,ref:r,onReady:()=>console.log("I'm ready, loaded ".concat(t,"!"))});return(0,n.jsx)("div",{style:{...o.$n,margin:"auto"},children:(0,n.jsx)("div",{style:l.yG,children:c})})};var d=r(7830),u=r(4304),h=r(653),m=r(5334),g=r(1850);function p(){return{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}}class x{interpolate(e){let t,r,n,i,s,a;for(r=a=this.x.length-2;(a<=0?r<=0:r>=0)&&!(this.x[r]<=e);a<=0?r+=1:r-=1);return t=this.x[r+1]-this.x[r],i=Math.pow(n=(e-this.x[r])/t,2),(2*(s=Math.pow(n,3))-3*i+1)*this.y[r]+(s-2*i+n)*t*this.m[r]+(-2*s+3*i)*this.y[r+1]+(s-i)*t*this.m[r+1]}constructor(e,t){let r,n,i,s,a,l,o,c,d,u,h,m,g,p,x,f,y;for(a=0,o=e.length,i=[],l=[],r=[],n=[],s=[],c=[],p=o-1;0<=p?a<p:a>p;0<=p?a+=1:a-=1)i[a]=(t[a+1]-t[a])/(e[a+1]-e[a]),a>0&&(l[a]=(i[a-1]+i[a])/2);for(a=0,l[0]=i[0],l[o-1]=i[o-2],d=[],x=o-1;0<=x?a<x:a>x;0<=x?a+=1:a-=1)0===i[a]&&d.push(a);for(u=0,m=d.length;u<m;u++)l[a=d[u]]=l[a+1]=0;for(a=0,f=o-1;0<=f?a<f:a>f;0<=f?a+=1:a-=1)r[a]=l[a]/i[a],n[a]=l[a+1]/i[a],s[a]=Math.pow(r[a],2)+Math.pow(n[a],2),c[a]=3/Math.sqrt(s[a]);for(a=0,d=[],y=o-1;0<=y?a<y:a>y;0<=y?a+=1:a-=1)s[a]>9&&d.push(a);for(h=0,g=d.length;h<g;h++)l[a=d[h]]=c[a]*r[a]*i[a],l[a+1]=c[a]*n[a]*i[a];this.x=e.slice(0,o),this.y=t.slice(0,o),this.m=l}}var f=r(1477);let y="osmd";class v extends g.OpenSheetMusicDisplay{setup(){this.rules.FingeringPosition=1,this.rules.FingeringOffsetY=1,this.rules.FingeringPositionFromXML=!1}}let j=async(e,t,r,n)=>(e.setCustomPageFormat(t,r),e.Zoom=n,e.IsReadyToRender()||console.warn("Should not render"),e.render(),e),w=(e,t,r)=>[...Array(r)].map((n,i)=>e+(t-e)*i/r),I=e=>{let[t,r]=(0,s.useState)(null),[i,a]=(0,s.useState)({x:0,y:0}),[l,o]=(0,s.useState)(null),{height:c}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,[t,r]=(0,s.useState)(p());return(0,s.useEffect)(()=>{let t,n=()=>{void 0!==t&&clearTimeout(t),t=setTimeout(()=>{r(p())},e)};return window.addEventListener("resize",n),()=>{void 0!==t&&clearTimeout(t),window.removeEventListener("resize",n)}},[]),t}(),d=f.f.getZoom(),u=Math.max(150,.2*c),h=Math.max(Math.min(1,u/260),.5)*d,m=u*h,g=f.f.isHorizontalMode()?4e4*m:window.innerWidth,{getTime:I,measureMap:b,xml:A}=e;(0,s.useEffect)(()=>{(async()=>{let e=new v(y,{drawCredits:!1,drawPartNames:!1,measureNumberInterval:4});e.setup(),await e.load(A),r(e)})()},[A]),(0,s.useEffect)(()=>(null!=t&&(async()=>{let e=f.f.isHorizontalMode()?u*d:1e5;await j(t,g,e,h),o({ip:((e,t)=>{let r=e.GraphicSheet.MeasureList,n=r.map(e=>{var t;return null==(t=e[0])?void 0:t.stave.x}),i=Object.entries(t).map(e=>[parseFloat(e[0]),e[1]]);if(i.sort((e,t)=>e[0]-t[0]),i=[[0,0]].concat(i),!f.f.isHorizontalMode()){let e=r.map(e=>{var t;return null==(t=e[0])?void 0:t.stave.y}),t=e[0];e=e.map(e=>e-t);let i=0,s=[[0,0]],a=[];e.forEach((e,t)=>{if(isNaN(e))return void console.log("Found Nan :(");if(e!=i){let e=s[s.length-1],r=w(e[1],i,t-e[0]);a=a.concat(r),s.push([t,i])}i=e});let l=s[s.length-1],o=e.length-1;if(l[0]!=o){s.push([o,i]);let e=w(l[1],i,o-l[0]);(a=a.concat(e)).push(i)}else a.push(l[1]);n=a}let s=i.length,[a,l]=i[0],o=[],c=[];for(let e=0;e<s-1;++e){let[t,r]=i[e+1];if(void 0!==n[r-1]){for(let e=l;e<r;++e){let i=n[e-1];if(void 0!==i){let n=a+(t-a)*(e-l)/(r-l);o.push(n),c.push(i)}}a=t,l=r}}o.push(a),c.push(n[l-1]),[1,2].forEach(e=>{o.push(a+5*e),c.push(n[l-1])});let d=.3*!!f.f.isHorizontalMode(),u=new x(o,c);return(e,t)=>Math.max(0,(e<=o[0]?c[0]:e>=o[o.length-1]?c[c.length-1]:u.interpolate(e))*t-d*window.innerWidth)})(t,b)})})(),()=>{o(null)}),[t,b,u,d,h,g]),(0,s.useEffect)(()=>{if(null!==l){let e=l.ip,t=setInterval(async()=>{let t=e(await I(),h);a(f.f.isHorizontalMode()?{x:t,y:0}:{x:0,y:t})},20);return()=>{clearInterval(t)}}},[I,l,h]);let C=f.f.isHorizontalMode()?u*d:800;return(0,n.jsx)("div",{style:{overflow:"hidden"},children:(0,n.jsx)("div",{id:y,style:{height:"".concat(C+i.y,"px"),width:"".concat(g,"px"),marginLeft:"-".concat(i.x,"px"),marginTop:"-".concat(i.y,"px")}})})};var b=r(8886);let A=[1,0,-1],C=async e=>(await fetch(e)).text(),S=(e,t,r,n)=>{let i=(0,o.qU)(e,t);i.childNodes.forEach(e=>{e.nodeName===r&&e.id!==n&&i.removeChild(e)})},k=e=>{let t=e.parts[e.currPartIdx].id,r=(e=>{let t=e.cloneNode(!0);return t.xmlStandalone=e.xmlStandalone,t})(e.origXml);S(r,"part-list","score-part",t),S(r,"score-partwise","part",t);let n=f.f.getFingering();return(0,o.mg)(r,e.pitch,e.octave,n),r},F=e=>{let{scoreInfo:t,player:r}=e,i="/mxl/".concat(t.fileName,".musicxml"),a="https://musescore.com/user/83726533/scores/".concat(t.source),c=(0,b.N)(),{t:g}=(0,u.A)(),[p,x]=(0,s.useState)(null);if((0,s.useEffect)(()=>{(async()=>{let e=await C(i),t=(0,o.NO)(e),r={xml:t,parts:(e=>{let t=(0,o.qU)(e,"score-partwise"),r=[];for(let e of t.getElementsByTagName("score-part"))r.push({id:e.id,name:e.getElementsByTagName("part-name")[0].textContent});return r})(t),currPartIdx:0,origXml:t,pitch:f.f.getInstrumentKey(),octave:0};x({...r,xml:k(r)})})()},[i]),null!==p){let e=p.pitch,s=p.currPartIdx,u=p.octave,m=(t,r,n)=>{if(t===s&&r===e&&n===u)return;let i={...p,currPartIdx:t,pitch:r,octave:n},a=k(i);x({...i,xml:a,currPartIdx:t})},f=e=>e>0?"+".concat(e):"".concat(e),y=g("octave"),v=0===u?y:"".concat(y,": ").concat(f(u)),j=A.map(t=>({name:f(t),onClick:()=>m(s,e,t),key:f(t)})),w=(0,n.jsx)(h.D4,{options:j,children:v}),b=o.S4.map((e,t)=>({name:e,onClick:()=>m(s,e,u),key:e})),C=g("instrumentKeyShort"),S=(0,n.jsx)(h.D4,{options:b,children:"".concat(C,": ").concat(e)}),F=c.options[0],N={...F,onClick:()=>F.onClick(t.videoId),key:"addFav"},E={...l.zA,style:{...l.zA.style,minWidth:"30px"}},M=(0,n.jsx)(h.D4,{options:[N],wrapper:(e,t)=>(0,n.jsxs)("button",{onClick:t,...E,children:[(0,n.jsx)(d.a95,{})," "]}),children:"..."}),U=(0,n.jsxs)("div",{style:l.eL,children:[M,S,w]}),D=(0,n.jsx)(I,{xml:p.xml,measureMap:t.measureMap,getTime:r.getTime},i),T=(0,n.jsx)("div",{style:{width:o.$n.width,maxWidth:o.$n.maxWidth,margin:"auto"},children:(0,n.jsxs)("div",{style:{...l.yG,...l.Xe},children:[(0,n.jsxs)("h4",{children:[g("viewSheetsOn"),(0,n.jsx)("br",{}),(0,n.jsx)("a",{href:a,target:"_blank",children:"MuseScore.com"})]}),U]})}),z=(0,n.jsx)("div",{style:{width:o.$n.width,maxWidth:o.$n.maxWidth,margin:"auto"},children:(0,n.jsxs)("div",{style:{...l.yG,...l.Xe},children:[(0,n.jsx)("h3",{children:t.name}),(0,n.jsx)("h3",{children:"-"}),(0,n.jsx)("h3",{children:t.artist})]})});return(0,n.jsxs)(n.Fragment,{children:[z,r.comp,T,D,c.overlay]})}return(0,n.jsx)(m.Loading,{addComp:!0})};var N=r(9252);let E=e=>{let t=o.wA.filter(t=>t.videoId===e.scoreId);if(0===t.length)return(0,n.jsxs)("h3",{children:["YouTube score with ID ",(0,n.jsx)("b",{children:e.scoreId})," not found :("]});let r=t[0];return(0,n.jsx)(M,{scoreInfo:r})},M=e=>{let{scoreInfo:t}=e,r=(e=>{let t=(0,s.useRef)(null),r=(0,s.useCallback)(async()=>{var e;return await (null==(e=t.current)?void 0:e.getInternalPlayer().getCurrentTime())},[t]);return{comp:(0,n.jsx)(c,{playerRef:t,videoId:e}),getTime:r}})(t.videoId);return(0,n.jsx)(F,{scoreInfo:t,player:r})},U=()=>{let e=(0,i.useSearchParams)().get("scoreId");return void 0===e||"string"!=typeof e?(0,n.jsx)(N.To404,{}):(0,n.jsx)(E,{scoreId:e})}},2978:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>d,Rb:()=>m,iZ:()=>h});var n=r(2078),i=r(3885),s=r(9708),a=r(2115);let l={apiKey:"AIzaSyCVJ76vO0YNHlGwCtvkKfDe5rWLxFiIzgA",authDomain:"ytpa-f7aca.firebaseapp.com",projectId:"ytpa-f7aca",storageBucket:"ytpa-f7aca.firebasestorage.app",messagingSenderId:"374268704603",appId:"1:374268704603:web:646ec6a00d2b5d45968c7e",measurementId:"G-860EZ6JGNF"};class o{userLoggedIn(){let e=this.firebaseAuth.currentUser;return!!(null==e?void 0:e.emailVerified)}currentUser(){return this.firebaseAuth.currentUser}getUserName(){var e,t;return(null!=(t=null==(e=c.currentUser())?void 0:e.email)?t:"@").split("@")[0]}getAuth(){return this.firebaseAuth}async signOut(){try{await (0,i.CI)(this.firebaseAuth)}catch(e){console.error("Error signing out:",e)}}async signIn(e,t){try{if(!(await (0,i.x9)(this.firebaseAuth,e,t)).user.emailVerified)return{error:"Email not verified!"}}catch(e){return{error:"Sign-in failed, error: ".concat(e)}}return{info:"Sucessfully signed-in."}}async signUp(e,t){try{let r=(await (0,i.eJ)(this.firebaseAuth,e,t)).user;return await (0,i.gA)(r),console.log("Success: Created user ".concat(r.uid,"!")),{info:"Created user account, verify your email and log in."}}catch(e){return{error:"Sign-up failed, error: ".concat(e)}}}async addFavorite(e){let t=this.getUserDoc(),r=await (0,s.x7)(t);if(r.exists()){let n=Array.from(new Set([...r.data().allFavorites||[],e]));await (0,s.mZ)(t,{allFavorites:n})}else console.log("creating new"),await (0,s.BN)(t,{allFavorites:[e]})}async getFavorites(){let e=this.getUserDoc(),t=await (0,s.x7)(e);return t.exists()&&t.data().allFavorites||[]}async removeFromFavorites(e){let t=this.getUserDoc(),r=await (0,s.x7)(t);if(r.exists()){let n=(r.data().allFavorites||[]).filter(t=>t!=e);await (0,s.mZ)(t,{allFavorites:n})}}async storeUserDoc(e){let t=this.currentUser();if(null==t)return"Not logged-in.";try{await (0,s.BN)((0,s.H9)(this.firestoreDb,"users",t.uid),e)}catch(e){return e}}getUserDoc(){let e=this.currentUser();console.assert(null!=e);let t=e.uid;return(0,s.H9)(this.firestoreDb,"users",t)}constructor(){let e=(0,n.Wp)(l);this.firebaseAuth=(0,i.xI)(e),this.firestoreDb=(0,s.aU)(e)}}let c=new o,d=c,u=e=>{var t;return(null!=(t=e.email)?t:"user@").split("@")[0]},h=()=>{let[e,t]=(0,a.useState)(void 0);return(0,a.useEffect)(()=>{let e=c.getAuth(),r=(0,i.hg)(e,e=>{e?localStorage.setItem("username",u(e)):localStorage.removeItem("username"),t(e||null)});return()=>r()},[]),e},m=e=>{let t=null;if(e)t=u(e);else if(void 0===e){console.log("Grabbing username from localstorage");let e=localStorage.getItem("username");null!==e&&(t=e)}return t}},3841:(e,t,r)=>{Promise.resolve().then(r.bind(r,5334)),Promise.resolve().then(r.bind(r,1203))},5334:(e,t,r)=>{"use strict";r.d(t,{Loading:()=>a});var n=r(5155),i=r(4304),s=r(8242);let a=e=>{let{title:t,addComp:r}=e,{t:a}=(0,i.A)(),l=null!=t?t:(0,n.jsx)("h4",{children:t}),o=(0,n.jsxs)(n.Fragment,{children:[l,(0,n.jsx)("p",{children:a("loading")})]});return r?(0,n.jsx)("div",{className:"container",children:(0,n.jsx)("div",{style:s.yG,children:o})}):o}},8886:(e,t,r)=>{"use strict";r.d(t,{f:()=>v,N:()=>y});var n=r(5155),i=r(2619),s=r.n(i),a=r(7830),l=r(4304),o=r(2978),c=r(653),d=r(2115),u=r(8242),h=r(883);let m="80px",g={font:"inherit",color:"inherit",textDecoration:"none",height:m,display:"block",padding:0,margin:0},p={paddingTop:0,paddingBottom:0,paddingRight:0},x={...p,paddingLeft:".4em"},f=(e,t)=>(0,n.jsx)(s(),{style:g,href:t,children:(0,n.jsx)("div",{style:{height:m,alignContent:"center"},children:e})}),y=()=>{let{t:e}=(0,l.A)(),t=(e=>{let[t,r]=(0,d.useState)(!1),{t:i}=(0,l.A)();return{open:()=>r(!0),component:(0,n.jsx)(n.Fragment,{children:t&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,n.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"10px",textAlign:"center",maxWidth:"300px"},children:[(0,n.jsx)("p",{style:{margin:"0 0 20px"},children:e}),(0,n.jsx)("button",{onClick:()=>{r(!1)},...u.zA,children:i("close")})]})})})}})(e("notLoggedIn"));return{options:[{name:e("favoritesAdd"),onClick:e=>{o.Ay.userLoggedIn()||t.open(),o.Ay.addFavorite(e)}}],overlay:t.component}},v=e=>{let{scores:t,sortInfo:r,options:i}=e,{t:s,getLink:o}=(0,l.A)(),d=i||[],u=d.map(e=>({key:e.name,...e})),g=(0,c.KS)((0,n.jsx)(a.a95,{}),u,(e,t)=>(0,n.jsx)("div",{onClick:t,style:{display:"flex",height:m,alignContent:"center",alignItems:"center",justifyContent:"center"},children:e}),{width:"100%"}),y={textAlign:"left",...x},v=d.length>0,w=v?"38%":"40%",I=h.Ul.map(e=>{let t="";return void 0!==r&&r.by===e&&(t=r.ascending?"▴":"▾"),(0,n.jsxs)("th",{onClick:()=>null==r?void 0:r.sortClick(e),style:{cursor:"pointer",width:w,...y},children:[s(e),t]},e)}),b=v?(0,n.jsx)("th",{style:{width:"4%",...y}}):void 0,A=(0,n.jsx)("thead",{style:{width:"100%"},children:(0,n.jsxs)("tr",{style:{width:"100%"},children:[(0,n.jsx)("th",{style:{width:"10%",...y}}),I,(0,n.jsx)("th",{style:{width:"10%",...y},children:s("songKey")}),b]})});return(0,n.jsxs)("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:"0 ".concat("6px")},children:[A,(0,n.jsx)("tbody",{children:t.map(e=>{let t=v?(0,n.jsx)("td",{style:x,children:g(e.videoId)}):void 0,r=o("/piece?scoreId=".concat(e.videoId));return(0,n.jsxs)("tr",{style:{cursor:"pointer",height:m},className:"hoverlink",children:[(0,n.jsx)("td",{style:p,children:f((0,n.jsx)("img",{height:m,src:"https://img.youtube.com/vi/".concat(e.videoId,"/default.jpg"),alt:"YouTube thumbnail of ".concat(e.name," by ").concat(e.artist)}),r)}),h.Ul.map(t=>{var i;return(0,n.jsx)("td",{style:x,children:f(null==(i=e[t])?void 0:i.trim(),r)},"td-".concat(t))}),(0,n.jsx)("td",{style:x,children:f(j(e.keys),r)}),t]},e.videoId)})})]})},j=e=>e.map(h.Gn).join(", ")},9252:(e,t,r)=>{"use strict";r.d(t,{To404:()=>l});var n=r(5155),i=r(63),s=r(2115),a=r(4304);let l=()=>{let{getLink:e}=(0,a.A)(),t=(0,i.useRouter)();return(0,s.useEffect)(()=>{t.push(e("/404"))}),(0,n.jsx)(n.Fragment,{})}}},e=>{e.O(0,[992,811,479,849,366,619,558,158,935,441,255,358],()=>e(e.s=3841)),_N_E=e.O()}]);