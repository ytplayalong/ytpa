(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[714],{8705:function(e,t,r){Promise.resolve().then(r.bind(r,6810)),Promise.resolve().then(r.bind(r,5060))},6810:function(e,t,r){"use strict";r.d(t,{Loading:function(){return a}});var n=r(7437),i=r(8138),s=r(5061);let a=e=>{let{title:t,addComp:r}=e,{t:a}=(0,i.Z)(),l=null!=t?t:(0,n.jsx)("h4",{children:t}),o=(0,n.jsxs)(n.Fragment,{children:[l,(0,n.jsx)("p",{children:a("loading")})]});return r?(0,n.jsx)("div",{className:"container",children:(0,n.jsx)("div",{style:s.yR,children:o})}):o}},5060:function(e,t,r){"use strict";r.d(t,{QueryScore:function(){return D}});var n=r(7437),i=r(9376),s=r(2265),a=r(5107),l=r(5061),o=r(2641);let c=e=>{let t=(0,s.useRef)(),r=(0,s.useCallback)(async()=>{var e;return await (null===(e=t.current)||void 0===e?void 0:e.getInternalPlayer().getCurrentTime())},[t]);return{comp:(0,n.jsx)(d,{playerRef:t,videoId:e}),getTime:r}},d=e=>{let{videoId:t,playerRef:r}=e,i={...o.g1,playerVars:{autoplay:1}},c=s.createElement(a.Z,{videoId:t,opts:i,ref:r,onReady:()=>console.log("I'm ready, loaded ".concat(t,"!"))});return(0,n.jsx)("div",{style:{...o.g1,margin:"auto"},children:(0,n.jsx)("div",{style:l.yR,children:c})})};var u=r(2744),h=r(8138),g=r(5259),p=r(6810),m=r(2828);function f(){let{innerWidth:e,innerHeight:t}=window;return{width:e,height:t}}class x{interpolate(e){let t,r,n,i,s,a,l,o,c,d;for(a=d=this.x.length-2;(d<=0?a<=0:a>=0)&&!(this.x[a]<=e);d<=0?a+=1:a-=1);return t=this.x[a+1]-this.x[a],o=Math.pow(l=(e-this.x[a])/t,2),r=2*(c=Math.pow(l,3))-3*o+1,i=c-2*o+l,n=-2*c+3*o,s=c-o,r*this.y[a]+i*t*this.m[a]+n*this.y[a+1]+s*t*this.m[a+1]}constructor(e,t){let r,n,i,s,a,l,o,c,d,u,h,g,p,m,f,x,v;for(a=0,o=e.length,i=[],l=[],r=[],n=[],s=[],c=[],m=o-1;0<=m?a<m:a>m;0<=m?a+=1:a-=1)i[a]=(t[a+1]-t[a])/(e[a+1]-e[a]),a>0&&(l[a]=(i[a-1]+i[a])/2);for(a=0,l[0]=i[0],l[o-1]=i[o-2],d=[],f=o-1;0<=f?a<f:a>f;0<=f?a+=1:a-=1)0===i[a]&&d.push(a);for(u=0,g=d.length;u<g;u++)l[a=d[u]]=l[a+1]=0;for(a=0,x=o-1;0<=x?a<x:a>x;0<=x?a+=1:a-=1)r[a]=l[a]/i[a],n[a]=l[a+1]/i[a],s[a]=Math.pow(r[a],2)+Math.pow(n[a],2),c[a]=3/Math.sqrt(s[a]);for(a=0,d=[],v=o-1;0<=v?a<v:a>v;0<=v?a+=1:a-=1)s[a]>9&&d.push(a);for(h=0,p=d.length;h<p;h++)l[a=d[h]]=c[a]*r[a]*i[a],l[a+1]=c[a]*n[a]*i[a];this.x=e.slice(0,o),this.y=t.slice(0,o),this.m=l}}var v=r(4267);let y="osmd";class j extends m.OpenSheetMusicDisplay{setup(){this.rules.FingeringPosition=1,this.rules.FingeringOffsetY=1,this.rules.FingeringPositionFromXML=!1}}let w=async(e,t,r,n)=>{let i=new j(y,{drawCredits:!1,drawPartNames:!1,measureNumberInterval:4});return i.setup(),await i.load(e),i.setCustomPageFormat(t,r),i.Zoom=n,i.render(),i},b=(e,t,r)=>[...Array(r)].map((n,i)=>e+(t-e)*i/r),I=(e,t)=>{let r=e.GraphicSheet.MeasureList,n=r.map(e=>{var t;return null===(t=e[0])||void 0===t?void 0:t.stave.x}),i=Object.entries(t).map(e=>[parseFloat(e[0]),e[1]]);if(i.sort((e,t)=>e[0]-t[0]),i=[[0,0]].concat(i),!v.r.isHorizontalMode()){let e=r.map(e=>{var t;return null===(t=e[0])||void 0===t?void 0:t.stave.y}),t=e[0];e=e.map(e=>e-t);let i=0,s=[[0,0]],a=[];e.forEach((e,t)=>{if(isNaN(e)){console.log("Found Nan :(");return}if(e!=i){let e=s[s.length-1],r=b(e[1],i,t-e[0]);a=a.concat(r),s.push([t,i])}i=e});let l=s[s.length-1],o=e.length-1;if(l[0]!=o){s.push([o,i]);let e=b(l[1],i,o-l[0]);(a=a.concat(e)).push(i)}n=a}let s=i.length,[a,l]=i[0],o=[],c=[];for(let e=0;e<s-1;++e){let[t,r]=i[e+1];if(void 0!==n[r-1]){for(let e=l;e<r;++e){let i=n[e-1];if(void 0!==i){let n=a+(t-a)*(e-l)/(r-l);o.push(n),c.push(i)}}a=t,l=r}}o.push(a),c.push(n[l-1]),[1,2].forEach(e=>{o.push(a+5*e),c.push(n[l-1])});let d=v.r.isHorizontalMode()?.3:0,u=new x(o,c);return(e,t)=>Math.max(0,(e<=o[0]?c[0]:e>=o[o.length-1]?c[c.length-1]:u.interpolate(e))*t-d*window.innerWidth)},C=e=>{let[t,r]=(0,s.useState)({x:0,y:0}),[i,a]=(0,s.useState)(null),{height:l}=function(){let[e,t]=(0,s.useState)(f());return(0,s.useEffect)(()=>{function e(){t(f())}return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}(),o=v.r.getZoom(),c=Math.max(150,.2*l),d=Math.max(Math.min(1,c/260),.5)*o,u=c*d,h=v.r.isHorizontalMode()?4e4*u:window.innerWidth,{getTime:g,measureMap:p,xml:m}=e;(0,s.useEffect)(()=>((async()=>{let e=v.r.isHorizontalMode()?c*o:1e5;a({ip:I(await w(m,h,e,d),p)})})(),()=>{a(null)}),[m,p,c,o,d,h]),(0,s.useEffect)(()=>{if(null!==i){let e=i.ip,t=setInterval(async()=>{let t=e(await g(),d);r(v.r.isHorizontalMode()?{x:t,y:0}:{x:0,y:t})},20);return()=>{clearInterval(t)}}},[g,i,d]);let x=v.r.isHorizontalMode()?c*o:800;return(0,n.jsx)("div",{style:{overflow:"hidden"},children:(0,n.jsx)("div",{id:y,style:{height:"".concat(x+t.y,"px"),width:"".concat(h,"px"),marginLeft:"-".concat(t.x,"px"),marginTop:"-".concat(t.y,"px")}})})};var S=r(4403);let k=[1,0,-1],F=async e=>(await fetch(e)).text(),M=(e,t,r,n)=>{let i=(0,o.s1)(e,t);i.childNodes.forEach(e=>{e.nodeName===r&&e.id!==n&&i.removeChild(e)})},N=e=>{let t=e.cloneNode(!0);return t.xmlStandalone=e.xmlStandalone,t},E=e=>{let t=e.parts[e.currPartIdx].id,r=N(e.origXml);M(r,"part-list","score-part",t),M(r,"score-partwise","part",t);let n=v.r.getFingering();return(0,o.p4)(r,e.pitch,e.octave,n),r},A=e=>{let t=(0,o.s1)(e,"score-partwise"),r=[];for(let e of t.getElementsByTagName("score-part"))r.push({id:e.id,name:e.getElementsByTagName("part-name")[0].textContent});return r},P=()=>v.r.getInstrumentKey(),L=e=>{let{scoreInfo:t,player:r}=e,i="/mxl/".concat(t.fileName,".musicxml"),a="https://musescore.com/user/83726533/scores/".concat(t.source),c=(0,S.r)(),{t:d}=(0,h.Z)(),[m,f]=(0,s.useState)(null);if((0,s.useEffect)(()=>{(async()=>{let e=await F(i),t=(0,o.ON)(e),r={xml:t,parts:A(t),currPartIdx:0,origXml:t,pitch:P(),octave:0};f({...r,xml:E(r)})})()},[i]),null!==m){let e=m.pitch,s=m.currPartIdx,h=m.octave,p=(t,r,n)=>{if(t===s&&r===e&&n===h)return;let i={...m,currPartIdx:t,pitch:r,octave:n},a=E(i);f({...i,xml:a,currPartIdx:t})},x=e=>e>0?"+".concat(e):"".concat(e),v=d("octave"),y=0===h?v:"".concat(v,": ").concat(x(h)),j=k.map(t=>({name:x(t),onClick:()=>p(s,e,t),key:x(t)})),w=(0,n.jsx)(g.Hc,{options:j,children:y}),b=e=>p(s,e,h),I=o.xj.map((e,t)=>({name:e,onClick:()=>b(e),key:e})),S=d("instrumentKeyShort"),F=(0,n.jsx)(g.Hc,{options:I,children:"".concat(S,": ").concat(e)}),M=c.options[0],N={...M,onClick:()=>M.onClick(t.videoId),key:"addFav"},A={...l.CL,style:{...l.CL.style,minWidth:"30px"}},P=(0,n.jsx)(g.Hc,{options:[N],wrapper:(e,t)=>(0,n.jsxs)("button",{onClick:t,...A,children:[(0,n.jsx)(u.rgS,{})," "]}),children:"..."}),L=(0,n.jsxs)("div",{style:l.Pp,children:[P,F,w]}),U=(0,n.jsx)(C,{xml:m.xml,measureMap:t.measureMap,getTime:r.getTime},i),T=(0,n.jsx)("div",{style:{width:o.g1.width,maxWidth:o.g1.maxWidth,margin:"auto"},children:(0,n.jsxs)("div",{style:{...l.yR,...l.W9},children:[(0,n.jsxs)("h4",{children:[d("viewSheetsOn"),(0,n.jsx)("br",{}),(0,n.jsx)("a",{href:a,target:"_blank",children:"MuseScore.com"})]}),L]})}),Z=(0,n.jsx)("div",{style:{width:o.g1.width,maxWidth:o.g1.maxWidth,margin:"auto"},children:(0,n.jsxs)("div",{style:{...l.yR,...l.W9},children:[(0,n.jsx)("h3",{children:t.name}),(0,n.jsx)("h3",{children:"-"}),(0,n.jsx)("h3",{children:t.artist})]})});return(0,n.jsxs)(n.Fragment,{children:[Z,r.comp,T,U,c.overlay]})}return(0,n.jsx)(p.Loading,{addComp:!0})};var U=r(9622);let T=e=>{let t=o.f$.filter(t=>t.videoId===e.scoreId);if(0===t.length)return(0,n.jsxs)("h3",{children:["YouTube score with ID ",(0,n.jsx)("b",{children:e.scoreId})," not found :("]});let r=t[0];return(0,n.jsx)(Z,{scoreInfo:r})},Z=e=>{let{scoreInfo:t}=e,r=c(t.videoId);return(0,n.jsx)(L,{scoreInfo:t,player:r})},D=()=>{let e=(0,i.useSearchParams)().get("scoreId");return void 0===e||"string"!=typeof e?(0,n.jsx)(U.To404,{}):(0,n.jsx)(T,{scoreId:e})}},4403:function(e,t,r){"use strict";r.d(t,{q:function(){return y},r:function(){return v}});var n=r(7437),i=r(7648),s=r(2744),a=r(8138),l=r(5172),o=r(5259),c=r(2265),d=r(5061),u=e=>{let[t,r]=(0,c.useState)(!1),{t:i}=(0,a.Z)();return{open:()=>r(!0),component:(0,n.jsx)(n.Fragment,{children:t&&(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,n.jsxs)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"10px",textAlign:"center",maxWidth:"300px"},children:[(0,n.jsx)("p",{style:{margin:"0 0 20px"},children:e}),(0,n.jsx)("button",{onClick:()=>{r(!1)},...d.CL,children:i("close")})]})})})}},h=r(2641);let g="80px",p={font:"inherit",color:"inherit",textDecoration:"none",height:g,display:"block",padding:0,margin:0},m={paddingTop:0,paddingBottom:0,paddingRight:0},f={...m,paddingLeft:".4em"},x=(e,t)=>(0,n.jsx)(i.default,{style:p,href:t,children:(0,n.jsx)("div",{style:{height:g,alignContent:"center"},children:e})}),v=()=>{let{t:e}=(0,a.Z)(),t=u(e("notLoggedIn"));return{options:[{name:e("favoritesAdd"),onClick:e=>{l.ZP.userLoggedIn()||t.open(),l.ZP.addFavorite(e)}}],overlay:t.component}},y=e=>{let{scores:t,sortInfo:r,options:i}=e,{t:l,getLink:c}=(0,a.Z)(),d=i||[],u=d.map(e=>({key:e.name,...e})),p=(0,o.h2)((0,n.jsx)(s.rgS,{}),u,(e,t)=>(0,n.jsx)("div",{onClick:t,style:{display:"flex",height:g,alignContent:"center",alignItems:"center",justifyContent:"center"},children:e}),{width:"100%"}),v={textAlign:"left",...f},y=d.length>0,w=y?"38%":"40%",b=h.MR.map(e=>{let t="";return void 0!==r&&r.by===e&&(t=r.ascending?"▴":"▾"),(0,n.jsxs)("th",{onClick:()=>null==r?void 0:r.sortClick(e),style:{cursor:"pointer",width:w,...v},children:[l(e),t]},e)}),I=y?(0,n.jsx)("th",{style:{width:"4%",...v}}):void 0,C=(0,n.jsx)("thead",{style:{width:"100%"},children:(0,n.jsxs)("tr",{style:{width:"100%"},children:[(0,n.jsx)("th",{style:{width:"10%",...v}}),b,(0,n.jsx)("th",{style:{width:"10%",...v},children:l("songKey")}),I]})});return(0,n.jsxs)("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:"0 ".concat("6px")},children:[C,(0,n.jsx)("tbody",{children:t.map(e=>{let t=y?(0,n.jsx)("td",{style:f,children:p(e.videoId)}):void 0,r=c("/piece?scoreId=".concat(e.videoId));return(0,n.jsxs)("tr",{style:{cursor:"pointer",height:g},className:"hoverlink",children:[(0,n.jsx)("td",{style:m,children:x((0,n.jsx)("img",{height:g,src:"https://img.youtube.com/vi/".concat(e.videoId,"/default.jpg"),alt:"YouTube thumbnail of ".concat(e.name," by ").concat(e.artist)}),r)}),h.MR.map(t=>{var i;return(0,n.jsx)("td",{style:f,children:x(null===(i=e[t])||void 0===i?void 0:i.trim(),r)},"td-".concat(t))}),(0,n.jsx)("td",{style:f,children:x(j(e.keys),r)}),t]},e.videoId)})})]})},j=e=>e.map(h.z8).join(", ")},9622:function(e,t,r){"use strict";r.d(t,{To404:function(){return l}});var n=r(7437),i=r(9376),s=r(2265),a=r(8138);let l=()=>{let{getLink:e}=(0,a.Z)(),t=(0,i.useRouter)();return(0,s.useEffect)(()=>{t.push(e("/404"))}),(0,n.jsx)(n.Fragment,{})}},5172:function(e,t,r){"use strict";r.d(t,{QY:function(){return h},xJ:function(){return u}});var n=r(738),i=r(4752),s=r(5978),a=r(2265);let l={apiKey:"AIzaSyCVJ76vO0YNHlGwCtvkKfDe5rWLxFiIzgA",authDomain:"ytpa-f7aca.firebaseapp.com",projectId:"ytpa-f7aca",storageBucket:"ytpa-f7aca.firebasestorage.app",messagingSenderId:"374268704603",appId:"1:374268704603:web:646ec6a00d2b5d45968c7e",measurementId:"G-860EZ6JGNF"};class o{userLoggedIn(){let e=this.firebaseAuth.currentUser;return!!(null==e?void 0:e.emailVerified)}currentUser(){return this.firebaseAuth.currentUser}getUserName(){var e,t;return(null!==(t=null===(e=c.currentUser())||void 0===e?void 0:e.email)&&void 0!==t?t:"@").split("@")[0]}getAuth(){return this.firebaseAuth}async signOut(){try{await (0,i.w7)(this.firebaseAuth)}catch(e){console.error("Error signing out:",e)}}async signIn(e,t){try{if(!(await (0,i.e5)(this.firebaseAuth,e,t)).user.emailVerified)return{error:"Email not verified!"}}catch(e){return{error:"Sign-in failed, error: ".concat(e)}}return{info:"Sucessfully signed-in."}}async signUp(e,t){try{let r=(await (0,i.Xb)(this.firebaseAuth,e,t)).user;return await (0,i.w$)(r),console.log("Success: Created user ".concat(r.uid,"!")),{info:"Created user account, verify your email and log in."}}catch(e){return{error:"Sign-up failed, error: ".concat(e)}}}async addFavorite(e){let t=this.getUserDoc(),r=await (0,s.QT)(t);if(r.exists()){let n=Array.from(new Set([...r.data().allFavorites||[],e]));await (0,s.r7)(t,{allFavorites:n})}else console.log("creating new"),await (0,s.pl)(t,{allFavorites:[e]})}async getFavorites(){let e=this.getUserDoc(),t=await (0,s.QT)(e);return t.exists()&&t.data().allFavorites||[]}async removeFromFavorites(e){let t=this.getUserDoc(),r=await (0,s.QT)(t);if(r.exists()){let n=(r.data().allFavorites||[]).filter(t=>t!=e);await (0,s.r7)(t,{allFavorites:n})}}async storeUserDoc(e){let t=this.currentUser();if(null==t)return"Not logged-in.";try{await (0,s.pl)((0,s.JU)(this.firestoreDb,"users",t.uid),e)}catch(e){return e}}getUserDoc(){let e=this.currentUser();console.assert(null!=e);let t=e.uid;return(0,s.JU)(this.firestoreDb,"users",t)}constructor(){let e=(0,n.ZF)(l);this.firebaseAuth=(0,i.v0)(e),this.firestoreDb=(0,s.ad)(e)}}let c=new o;t.ZP=c;let d=e=>{var t;return(null!==(t=e.email)&&void 0!==t?t:"user@").split("@")[0]},u=()=>{let[e,t]=(0,a.useState)(void 0);return(0,a.useEffect)(()=>{let e=c.getAuth(),r=(0,i.Aj)(e,e=>{e?localStorage.setItem("username",d(e)):localStorage.removeItem("username"),t(e||null)});return()=>r()},[]),e},h=e=>{let t=null;if(e)t=d(e);else if(void 0===e){console.log("Grabbing username from localstorage");let e=localStorage.getItem("username");null!==e&&(t=e)}return t}}},function(e){e.O(0,[358,400,51,170,822,648,434,480,209,971,117,744],function(){return e(e.s=8705)}),_N_E=e.O()}]);